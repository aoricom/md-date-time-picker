!function(e,t){if("function"==typeof define&&define.amd)define(["exports","moment","draggabilly"],t);else if("undefined"!=typeof exports)t(exports,require("moment"),require("draggabilly"));else{var i={exports:{}};t(i.exports,e.moment,e.draggabilly),e.mdDateTimePicker=i.exports}}(this,function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var d=a(t),l=a(i),n=function(){function e(e,t){for(var i,a=0;a<t.length;a++)i=t[a],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=function(){function e(t){var i=t.type,a=t.init,l=void 0===a?(0,d.default)():a,n=t.past,o=void 0===n?(0,d.default)().subtract(21,"years"):n,r=t.future,c=void 0===r?l:r,_=t.mode,h=void 0!==_&&_,m=t.orientation,u=void 0===m?"LANDSCAPE":m,p=t.trigger,g=void 0===p?"":p,v=t.ok,D=void 0===v?"ok":v,f=t.cancel,k=void 0===f?"cancel":f,C=t.unset,L=void 0===C?"not set":C,y=t.colon,b=void 0===y||y,w=t.autoClose,E=void 0!==w&&w,M=t.alignTo,x=void 0===M?null:M,I=t.begin,T=void 0===I?new Date:I,Y=t.end,S=void 0===Y?new Date:Y,A=t.inner24,V=void 0!==A&&A,N=t.prevHandle,H=void 0===N?'<div class="mddtp-prev-handle"></div>':N,P=t.nextHandle,z=void 0===P?'<div class="mddtp-next-handle"></div>':P,O=t.container,B=void 0===O?document.body:O,q=t.ranges,R=void 0===q?null:q,j=t.injectElement,F=void 0===j?null:j;s(this,e),this._type=i,this._init=l,this._past=o,this._future=c,this._mode=h,this._orientation=u,this._trigger=g,this._ok=D,this._cancel=k,this._unset=L,this._colon=b,this._autoClose=E,this._inner24=V,this._prevHandle=H,this._nextHandle=z,this._container=B,this._alignTo=x,this._ranges=R,this._begin=(0,d.default)(T),this._end=(0,d.default)(S),this._injectElement=F,this._sDialog={},"undefined"==typeof document||this._container.querySelector("#mddtp-picker__"+this._type)||this._buildDialog()}return n(e,[{key:"hide",value:function(){this._selectDialog(),this._hideDialog()}},{key:"show",value:function(){this._selectDialog(),"date"===this._type?this._initDateDialog(this._init):"time"===this._type&&this._initTimeDialog(this._init),this._showDialog()}},{key:"isOpen",value:function(){return this._selectDialog(),!!e.dialog.state}},{key:"isClosed",value:function(){return this._selectDialog(),!e.dialog.state}},{key:"toggle",value:function(){this._selectDialog(),e.dialog.state?this.hide():this.show()}},{key:"_selectDialog",value:function(){this._sDialog.picker=this._container.querySelector("#mddtp-picker__"+[this._type]);for(var e=["viewHolder","years","header","unset","ranger","inner","cancel","ok","left","right","previous","current","next","subtitle","title","titleDay","titleMonth","AM","PM","needle","hourView","minuteView","hour","minute","fakeNeedle","circularHolder","circle","dotSpan"],t=e.length;t--;)this._sDialog[e[t]]=this._container.querySelector("#mddtp-"+this._type+"__"+e[t]);this._sDialog.tDate=this._init.clone(),this._sDialog.sDate=this._init.clone(),this._ranges&&(this._sDialog.bDate=this._begin.clone(),this._sDialog.eDate=this._end.clone())}},{key:"_showDialog",value:function(){var t=this;if(e.dialog.state=!0,this._sDialog.picker.classList.remove("mddtp-picker--inactive"),this._sDialog.picker.classList.add("zoomIn"),this._alignTo){var i=this._alignTo.getBoundingClientRect(),a=i.y+i.height+8+this._sDialog.picker.offsetHeight/2,s=i.left+i.width-this._sDialog.picker.offsetWidth;this._sDialog.picker.style.top=a+"px",this._sDialog.picker.style.left=s+"px"}"PORTRAIT"===this._orientation&&this._sDialog.picker.classList.add("mddtp-picker--portrait"),setTimeout(function(){t._sDialog.picker.classList.remove("zoomIn")},300)}},{key:"_hideDialog",value:function(){var t=this,i=this._sDialog.years,a=t._sDialog.title,s=t._sDialog.subtitle,d=this._sDialog.inner,l=this._sDialog.ranger,n=this._sDialog.AM,o=this._sDialog.PM,r=this._sDialog.minute,c=this._sDialog.hour,_=this._sDialog.minuteView,h=this._sDialog.hourView,m=this._sDialog.picker,u=this._sDialog.needle,p=this._sDialog.dotSpan,g="mddtp-picker__color--active",v="mddtp-picker__circularView--hidden";e.dialog.state=!1,e.dialog.view=!0,this._sDialog.picker.classList.add("zoomOut"),"date"===this._type?(i.classList.remove("zoomIn","zoomOut"),i.classList.add("mddtp-picker__years--invisible"),a.classList.remove(g),s.classList.add(g),d.classList.remove("zoomOut"),l&&l.classList.remove("zoomOut")):(n.classList.remove(g),o.classList.remove(g),r.classList.remove(g),c.classList.add(g),_.classList.add(v),h.classList.remove(v),s.style.display="none",p.style.display="none",u.className="mddtp-picker__selection"),setTimeout(function(){t._sDialog.picker.classList.remove("mddtp-picker--portrait"),t._sDialog.picker.classList.remove("zoomOut"),t._sDialog.picker.classList.add("mddtp-picker--inactive");var e=m.cloneNode(!0);m.parentNode.replaceChild(e,m)},300)}},{key:"_buildDialog",value:function(){var e=this._type,t=document.createDocumentFragment(),i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),n=document.createElement("button"),o=document.createElement("button"),r=document.createElement("button");if(i.id="mddtp-picker__"+e,i.classList.add("mddtp-picker"),i.classList.add("mddtp-picker-"+e),i.classList.add("mddtp-picker--inactive"),i.classList.add("animated"),this._addId(a,"header"),this._addClass(a,"header"),i.appendChild(a),this._addClass(s,"body"),s.appendChild(l),i.appendChild(s),"date"===e){var c=document.createElement("div"),_=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),v=document.createElement("ul"),D=document.createElement("li"),f=document.createElement("li"),k=document.createElement("li"),C=document.createElement("button"),L=document.createElement("button"),y=document.createElement("ul");this._addId(h,"subtitle"),this._addClass(h,"subtitle"),this._addId(m,"title"),this._addClass(m,"title",["mddtp-picker__color--active"]),this._addId(u,"titleDay"),this._addId(p,"titleMonth"),m.appendChild(u),m.appendChild(p),a.appendChild(h),a.appendChild(m),this._addId(g,"viewHolder"),this._addClass(g,"viewHolder",["animated"]),this._addClass(v,"views"),this._addId(D,"previous"),D.classList.add("mddtp-picker__view"),this._addId(f,"current"),f.classList.add("mddtp-picker__view"),this._addId(k,"next"),k.classList.add("mddtp-picker__view"),this._addView(D),this._addView(f),this._addView(k),g.appendChild(v),v.appendChild(D),v.appendChild(f),v.appendChild(k),this._addId(C,"left"),C.classList.add("mddtp-button"),this._addClass(C,"left"),C.setAttribute("type","button"),C.innerHTML=this._prevHandle,this._addId(L,"right"),L.classList.add("mddtp-button"),this._addClass(L,"right"),L.setAttribute("type","button"),L.innerHTML=this._nextHandle,this._addId(y,"years"),this._addClass(y,"years",["mddtp-picker__years--invisible","animated"]),this._addClass(_,"inner",["animated"]),this._addId(_,"inner"),_.appendChild(g),_.appendChild(C),_.appendChild(L),this._addClass(c,"outer"),c.appendChild(_);var b=document.createElement("div");this._addId(b,"ranger"),this._addClass(b,"ranger",["animated"]),c.appendChild(b),c.appendChild(y),s.appendChild(c)}else{var w=document.createElement("div"),E=document.createElement("span"),M=document.createElement("span"),x=document.createElement("span"),I=document.createElement("div"),T=document.createElement("div"),Y=document.createElement("div"),S=document.createElement("div"),A=document.createElement("div"),V=document.createElement("span"),N=document.createElement("span"),H=document.createElement("span"),P=document.createElement("div"),z=document.createElement("div"),O=document.createElement("div");this._addId(w,"title"),this._addClass(w,"title"),this._addId(E,"hour"),E.classList.add("mddtp-picker__color--active"),M.textContent=":",this._addId(M,"dotSpan"),M.style.display="none",this._addId(x,"minute"),this._addId(I,"subtitle"),this._addClass(I,"subtitle"),I.style.display="none",this._addId(T,"AM"),T.textContent=(0,d.default)().localeData().meridiem(1,1,!0),this._addId(Y,"PM"),Y.textContent=(0,d.default)().localeData().meridiem(13,1,!0),w.appendChild(E),w.appendChild(M),w.appendChild(x),I.appendChild(T),I.appendChild(Y),a.appendChild(w),a.appendChild(I),this._addId(S,"circularHolder"),this._addClass(S,"circularHolder"),this._addId(A,"needle"),A.classList.add("mddtp-picker__selection"),this._addClass(V,"dot"),this._addClass(N,"line"),this._addId(H,"circle"),this._addClass(H,"circle"),this._addId(P,"minuteView"),P.classList.add("mddtp-picker__circularView"),P.classList.add("mddtp-picker__circularView--hidden"),this._addId(z,"fakeNeedle"),z.classList.add("mddtp-picker__circle--fake"),this._addId(O,"hourView"),O.classList.add("mddtp-picker__circularView"),A.appendChild(V),A.appendChild(N),A.appendChild(H),S.appendChild(A),S.appendChild(P),S.appendChild(z),S.appendChild(O),s.appendChild(S)}l.classList.add("mddtp-picker__action"),this._autoClose===!0&&(l.style.display="none"),this._addId(r,"unset"),r.classList.add("mddtp-button"),r.setAttribute("type","button"),this._addId(n,"cancel"),n.classList.add("mddtp-button"),n.setAttribute("type","button"),this._addId(o,"ok"),o.classList.add("mddtp-button"),o.setAttribute("type","button"),this._unset&&l.appendChild(r),l.appendChild(n),l.appendChild(o),s.appendChild(l),t.appendChild(i),this._container.appendChild(t)}},{key:"_initTimeDialog",value:function(e){var t=this._sDialog.hour,i=this._sDialog.minute,a=this._sDialog.subtitle,s=this._sDialog.dotSpan;if(this._mode){var d=parseInt(e.format("H"),10);0===d&&(d="00"),this._fillText(t,d),this._colon&&(s.style.display="initial")}else this._fillText(t,e.format("h")),e._locale.isPM(e.format("A"))?this._sDialog.PM.classList.add("mddtp-picker__color--active"):this._sDialog.AM.classList.add("mddtp-picker__color--active"),a.style.display="initial",s.style.display="initial";this._fillText(i,e.format("mm")),this._initHour(),this._initMinute(),this._attachEventHandlers(),this._changeM(),this._dragDial(),this._switchToView(t),this._switchToView(i),this._addClockEvent(),this._setButtonText()}},{key:"_initHour",value:function(){var e=this._sDialog.hourView,t=this._sDialog.needle,i="mddtp-hour__selected",a="mddtp-picker__cell--selected",s="mddtp-picker__cell--rotate-",d="mddtp-picker__cell",l=document.createDocumentFragment(),n=void 0;if(this._mode){var o=this._inner24===!0?10:5;n=parseInt(this._sDialog.tDate.format("H"),10);for(var r=1,c=o;r<=24;r++,c+=o){var _=document.createElement("div"),h=document.createElement("span");_.classList.add(d),h.textContent=24===r?"00":r;var m=c;this._inner24===!0&&r>12&&(m-=120,_.classList.add("mddtp-picker__cell--rotate24")),_.classList.add(s+m),n===r&&(_.id=i,_.classList.add(a),t.classList.add(s+m)),24===r&&0===n&&(_.id=i,_.classList.add(a),t.classList.add(s+m)),_.appendChild(h),l.appendChild(_)}}else{n=parseInt(this._sDialog.tDate.format("h"),10);for(var u=1,p=10;u<=12;u++,p+=10){var g=document.createElement("div"),v=document.createElement("span");g.classList.add(d),v.textContent=u,g.classList.add(s+p),n===u&&(g.id=i,g.classList.add(a),t.classList.add(s+p)),g.appendChild(v),l.appendChild(g)}}for(;e.lastChild;)e.removeChild(e.lastChild);e.appendChild(l)}},{key:"_initMinute",value:function(){for(var e=this._sDialog.minuteView,t=parseInt(this._sDialog.tDate.format("m"),10),i=document.createDocumentFragment(),a=5,s=10;a<=60;a+=5,s+=10){var d=document.createElement("div"),l=document.createElement("span");d.classList.add("mddtp-picker__cell"),l.textContent=60===a?this._numWithZero(0):this._numWithZero(a),0===t&&(t=60),d.classList.add("mddtp-picker__cell--rotate-"+s),(t===a||t-1===a||t+1===a||1===t&&60===a)&&(d.id="mddtp-minute__selected",d.classList.add("mddtp-picker__cell--selected")),d.appendChild(l),i.appendChild(d)}for(;e.lastChild;)e.removeChild(e.lastChild);e.appendChild(i)}},{key:"_initDateDialog",value:function(e){var t=this._sDialog.subtitle,i=this._sDialog.title,a=this._sDialog.titleDay,s=this._sDialog.titleMonth;this._ranges?(this._fillText(t,e.format("YYYY")),this._fillText(a,""),this._fillText(s,this._begin.format("MMM D, YYYY")+" - "+this._end.format("MMM D, YYYY")),this._initRange()):(this._fillText(t,e.format("YYYY")),this._fillText(a,e.format("ddd, ")),this._fillText(s,e.format("MMM D"))),this._initYear(),this._initViewHolder(),this._attachEventHandlers(),this._changeMonth(),this._switchToView(t),this._switchToView(i),this._setButtonText()}},{key:"_initViewHolder",value:function(){var e=this._sDialog.tDate,t=this._sDialog.current,i=this._sDialog.previous,a=this._sDialog.next,s=this._past,l=this._future;e.isBefore(s,"month")&&(e=s.clone()),e.isAfter(l,"month")&&(e=l.clone()),this._sDialog.tDate=e,this._initMonth(t,e),this._initMonth(a,(0,d.default)(this._getMonth(e,1))),this._initMonth(i,(0,d.default)(this._getMonth(e,-1))),this._toMoveMonth()}},{key:"_initRange",value:function(){for(var e=this._sDialog.ranger,t=new DocumentFragment,i=0;i<this._ranges.length;i++){var a=this._ranges[i],s=a.interval(),d=document.createElement("span");d.innerText=a.label,d.classList.add("mddtp-picker__range"),d.setAttribute("idx",i),t.appendChild(d),this._sDialog.bDate.isSame(s.begin,"day")&&this._sDialog.eDate.isSame(s.end,"day")&&d.classList.add("mddtp-picker__range--selected")}for(;e.lastChild;)e.removeChild(e.lastChild);this._injectElement&&this._injectElement(t,this,this._trigger||this._container),e.appendChild(t),this.__endSelected=!0,this._trigger.dispatchEvent(new CustomEvent("range-selected",{detail:{begin:this._sDialog.bDate,end:this._sDialog.eDate}})),this._addRangeClickEvent(e)}},{key:"_initMonth",value:function(e,t){var i=(0,d.default)(t).format("MMMM YYYY"),a=e.getElementsByTagName("div");this._fillText(a[0],i);var s=document.createDocumentFragment(),l=a[3],n=d.default.weekdays(!0).indexOf(d.default.weekdays(!1,(0,d.default)(t).date(1).day())),o=-1,r=-1,c=101,_=-1,h=parseInt((0,d.default)(t).endOf("month").format("D"),10)+n-1,m=n,u="mddtp-picker__cell",p=h;(0,d.default)().isSame(t,"month")&&(o=parseInt((0,d.default)().format("D"),10),o+=n-1),this._past.isSame(t,"month")&&(m=parseInt(this._past.format("D"),10),m+=n-1),this._future.isSame(t,"month")&&(p=parseInt(this._future.format("D"),10),p+=n-1),!this._ranges&&this._sDialog.sDate.isSame(t,"month")&&(r=parseInt((0,d.default)(t).format("D"),10),r+=n-1),this._ranges&&(this._sDialog.bDate.isBefore(t,"month")&&this._sDialog.eDate.isSameOrAfter(t,"month")?c=0:this._sDialog.bDate.isSame(t,"month")&&(c=this._sDialog.bDate.date(),c+=n-1),this._sDialog.eDate.isAfter(t,"month")&&this._sDialog.bDate.isSameOrBefore(t,"month")?_=42:this._sDialog.eDate.isSame(t,"month")&&(_=this._sDialog.eDate.date(),_+=n-1),c=101!==c||_===-1?c:0,_=_!==-1||101!==c?_:42);for(var g=0;g<42;g++){var v=document.createElement("span"),D=g-n+1;g>=n&&g<=h&&(g>p||g<m?v.classList.add(u+"--disabled"):(v.classList.add(u),g>=c&&g<=_&&v.classList.add(u+"--ranged"),this._ranges&&(this._addCellMouseEnterEvent(v),this._addCellMouseLeaveEvent(v))),this._fillText(v,D)),o===g&&v.classList.add(u+"--today"),r===g&&(v.classList.add(u+"--selected"),v.id="mddtp-date__selected"),s.appendChild(v)}for(;l.lastChild;)l.removeChild(l.lastChild);l.appendChild(s),this._addCellClickEvent(l)}},{key:"_initYear",value:function(){for(var e=this._sDialog.years,t=this._sDialog.tDate.year(),i=document.createDocumentFragment(),a=this._past.year(),s=this._future.year(),d=a;d<=s;d++){var l=document.createElement("li");l.textContent=d,d===t&&(l.id="mddtp-date__currentYear",l.classList.add("mddtp-picker__li--current")),i.appendChild(l)}for(;e.lastChild;)e.removeChild(e.lastChild);e.appendChild(i),this._changeYear(e)}},{key:"_pointNeedle",value:function(t){var i=60,a=void 0,s=this._sDialog.circle,d=this._sDialog.fakeNeedle,l=this._sDialog.circularHolder,n=t._sDialog.needle;n.className="",n.classList.add("mddtp-picker__selection"),e.dialog.view?t._mode?(i=24,0===(a=parseInt(t._sDialog.sDate.format("H"),10))&&(a=24)):(i=12,a=t._sDialog.sDate.format("h")):(a=t._sDialog.sDate.format("m"),t._autoClose!==!0&&setTimeout(function(){var e=l.getBoundingClientRect(),t=s.getBoundingClientRect();d.style.left="left:"+(t.left-e.left)+"px",d.style.top="top:"+(t.top-e.top)+"px"},300));var o=parseInt(a,10),r=t._calcRotation(i,o);r&&(n.classList.add(r),this._inner24===!0&&24===i&&o>12&&n.classList.add("mddtp-picker__cell--rotate24"))}},{key:"_switchToView",value:function(e){var t=this;"date"===this._type?e.onclick=function(){t._switchToDateView(e,t)}:(this._inner24===!0&&t._mode&&(parseInt(t._sDialog.sDate.format("H"),10)>12?t._sDialog.needle.classList.add("mddtp-picker__cell--rotate24"):t._sDialog.needle.classList.remove("mddtp-picker__cell--rotate24")),e.onclick=function(){t._switchToTimeView(t)})}},{key:"_switchToTimeView",value:function(t){var i=t._sDialog.hourView,a=t._sDialog.minuteView,s=t._sDialog.hour,d=t._sDialog.minute,l="mddtp-picker__circularView--hidden";i.classList.toggle(l),a.classList.toggle(l),s.classList.toggle("mddtp-picker__color--active"),d.classList.toggle("mddtp-picker__color--active"),e.dialog.view=!e.dialog.view,t._pointNeedle(t)}},{key:"_switchToDateView",value:function(t,i){t.setAttribute("disabled","");var a=i._sDialog.inner,s=i._sDialog.ranger,d=i._sDialog.years,l=i._sDialog.title,n=i._sDialog.subtitle,o=i._container.querySelector("#mddtp-date__currentYear");e.dialog.view?(a.classList.add("zoomOut"),s&&s.classList.add("zoomOut"),d.classList.remove("mddtp-picker__years--invisible"),d.classList.add("zoomIn"),o.scrollIntoViewIfNeeded&&o.scrollIntoViewIfNeeded()):(d.classList.add("zoomOut"),a.classList.remove("zoomOut"),a.classList.add("zoomIn"),s&&(s.classList.remove("zoomOut"),s.classList.add("zoomIn")),setTimeout(function(){d.classList.remove("zoomIn","zoomOut"),d.classList.add("mddtp-picker__years--invisible"),a.classList.remove("zoomIn"),s&&s.classList.remove("zoomIn")},300)),l.classList.toggle("mddtp-picker__color--active"),n.classList.toggle("mddtp-picker__color--active"),e.dialog.view=!e.dialog.view,setTimeout(function(){t.removeAttribute("disabled")},300)}},{key:"_addClockEvent",value:function(){var e=this,t=this._sDialog.hourView,i=this._sDialog.minuteView,a="mddtp-picker__cell--selected";t.onclick=function(t){var i="mddtp-hour__selected",s=e._container.querySelector("#"+i),d=0;t.target&&"SPAN"===t.target.nodeName&&(s.id="",s.classList.remove(a),t.target.parentNode.classList.add(a),t.target.parentNode.id=i,d=e._mode?parseInt(t.target.textContent,10):"AM"===e._sDialog.sDate.format("A")?t.target.textContent:parseInt(t.target.textContent,10)+12,e._sDialog.sDate.hour(d),e._sDialog.hour.textContent=t.target.textContent,e._pointNeedle(e),setTimeout(function(){e._switchToTimeView(e)},700))},i.onclick=function(t){var i="mddtp-minute__selected",s=e._container.querySelector("#"+i),d=0;t.target&&"SPAN"===t.target.nodeName&&(s&&(s.id="",s.classList.remove(a)),t.target.parentNode.classList.add(a),t.target.parentNode.id=i,d=t.target.textContent,e._sDialog.sDate.minute(d),e._sDialog.minute.textContent=d,e._pointNeedle(e),e._autoClose===!0&&e._sDialog.ok.onclick())}}},{key:"_addRangeClickEvent",value:function(e){var t=this;e.onclick=function(e){if(e.target&&"SPAN"===e.target.nodeName){var i=t._sDialog.subtitle,a=t._sDialog.titleMonth,s=t._sDialog.titleDay,l=parseInt(e.target.getAttribute("idx"));if(l!==l)return;var n=t._ranges[l].interval();t._sDialog.tDate=d.default.max(n.end,n.begin),t._sDialog.bDate=n.begin,t._sDialog.eDate=n.end,t._initViewHolder(),t._fillText(i,t._sDialog.tDate.year()),t._fillText(s,""),t._fillText(a,t._sDialog.bDate.format("MMM D, YYYY")+" - "+t._sDialog.eDate.format("MMM D, YYYY")),t.__endSelected=!0,t._trigger.dispatchEvent(new CustomEvent("range-selected",{detail:{begin:t._sDialog.bDate,end:t._sDialog.eDate}}));for(var o=t._sDialog.ranger.children,r=0;r<o.length;r++){var c=o[r];c.classList.contains("mddtp-picker__range")&&(c===e.target?c.classList.add("mddtp-picker__range--selected"):c.classList.remove("mddtp-picker__range--selected"))}}}}},{key:"_addCellMouseEnterEvent",value:function(e){var t=this;e.onmouseenter=function(e){var i=e.target,a=i.textContent,s=t._sDialog.tDate.clone().date(a);if(!t.__endSelected&&s.isAfter(t._sDialog.bDate,"day"))for(var d=i;d&&!d.classList.contains("mddtp-picker__cell--ranged")&&d.classList.contains("mddtp-picker__cell");)d.classList.add("mddtp-picker__cell--ranged"),d=d.previousElementSibling}}},{key:"_addCellMouseLeaveEvent",value:function(e){var t=this;e.onmouseleave=function(e){var i=e.target,a=i.textContent,s=t._sDialog.tDate.clone().date(a),d=t._sDialog.bDate;if(!t.__endSelected&&s.isAfter(d,"day")){var l="mddtp-picker__cell--ranged",n=i;if(d.isSame(s,"month"))for(;n&&n.classList.contains(l)&&n.classList.contains("mddtp-picker__cell")&&n.previousElementSibling&&n.previousElementSibling.classList.contains(l);)n.classList.remove(l),n=n.previousElementSibling;else for(;n&&n.classList.contains(l)&&n.classList.contains("mddtp-picker__cell");)n.classList.remove(l),n=n.previousElementSibling}}}},{key:"_addCellClickEvent",value:function(e){var t=this;e.onclick=function(e){if(e.target&&"SPAN"===e.target.nodeName&&e.target.classList.contains("mddtp-picker__cell"))if(t._ranges){var i=t._sDialog.bDate,a=e.target.textContent,s=t._sDialog.tDate.date(a),l="mddtp-picker__cell--selected",n=t._sDialog.subtitle,o=t._sDialog.titleMonth,r=t._sDialog.titleDay,c=t._container.querySelector("#mddtp-date__selected");if(c&&(c.classList.remove(l),c.id=""),!d.default.isMoment(i)||s.isBefore(i)||t.__endSelected){var _=t._container.querySelector("#mddtp-date__start"),h=t._container.querySelector("#mddtp-date__end");_&&(_.classList.remove(l),_.id=""),h&&(h.classList.remove(l),h.id=""),t._sDialog.bDate=s.clone(),t._sDialog.eDate=s.clone(),e.target.classList.add(l),e.target.id="mddtp-date__start",t.__endSelected=!1}else{t._sDialog.eDate=s.clone(),e.target.classList.add(l),e.target.id="mddtp-date__end",t.__endSelected=!0,t._trigger.dispatchEvent(new CustomEvent("range-selected",{detail:{begin:t._sDialog.bDate,end:t._sDialog.eDate}}));for(var m=t._sDialog.ranger.children,u=0;u<m.length;u++){var p=m[u],g=parseInt(p.getAttribute("idx"));if(g===g){var v=t._ranges[g],D=v.interval();t._sDialog.bDate.isSame(D.begin,"day")&&t._sDialog.eDate.isSame(D.end,"day")?p.classList.add("mddtp-picker__range--selected"):p.classList.remove("mddtp-picker__range--selected")}}}t._fillText(n,""+s.format("YYYY")),t._fillText(r,""),t._fillText(o,t._sDialog.bDate.format("MMM D, YYYY")+" - "+t._sDialog.eDate.format("MMM D, YYYY")),t._initViewHolder()}else{var f=e.target.textContent,k=t._sDialog.tDate.date(f),C="mddtp-date__selected",L="mddtp-picker__cell--selected",y=t._container.querySelector("#"+C),b=t._sDialog.subtitle,w=t._sDialog.titleDay,E=t._sDialog.titleMonth;y&&(y.classList.remove(L),y.id=""),e.target.classList.add(L),e.target.id=C,t._sDialog.sDate=k.clone(),t._fillText(b,k.year()),t._fillText(w,k.format("ddd, ")),t._fillText(E,k.format("MMM D")),t._autoClose===!0&&t._sDialog.ok.onclick()}}}},{key:"_toMoveMonth",value:function(){var e=this._sDialog.tDate,t=this._sDialog.left,i=this._sDialog.right,a=this._past,s=this._future;t.removeAttribute("disabled"),i.removeAttribute("disabled"),t.classList.remove("mddtp-button--disabled"),i.classList.remove("mddtp-button--disabled"),e.isSame(a,"month")&&(t.setAttribute("disabled",""),t.classList.add("mddtp-button--disabled")),e.isSame(s,"month")&&(i.setAttribute("disabled",""),i.classList.add("mddtp-button--disabled"))}},{key:"_changeMonth",value:function(){function e(e,d){var l=!1,n=t._sDialog.next,o=t._sDialog.current,r=t._sDialog.previous;i.setAttribute("disabled",""),a.setAttribute("disabled",""),o.classList.add(e),r.classList.add(e),n.classList.add(e);var c=d.cloneNode(!0),_=void 0;d===n?(_=r,o.parentNode.appendChild(c),n.id=o.id,o.id=r.id,r=o,o=n,n=c):(l=!0,_=n,r.id=o.id,o.id=n.id,n=o,o=r),setTimeout(function(){d===r&&(o.parentNode.insertBefore(c,o),r=c),t._sDialog.next=n,t._sDialog.current=o,t._sDialog.previous=r,o.classList.add(s),n.classList.add(s),r.classList.add(s),o.classList.remove(e),n.classList.remove(e),r.classList.remove(e),_.parentNode.removeChild(_)},300),setTimeout(function(){o.classList.remove(s),n.classList.remove(s),r.classList.remove(s),t._sDialog.tDate=l?t._getMonth(t._sDialog.tDate,-1):t._getMonth(t._sDialog.tDate,1),t._initViewHolder(),i.setAttribute("disabled",""),a.setAttribute("disabled","")},350),setTimeout(function(){i.classList.contains("mddtp-button--disabled")||i.removeAttribute("disabled"),a.classList.contains("mddtp-button--disabled")||a.removeAttribute("disabled")},500)}var t=this,i=this._sDialog.left,a=this._sDialog.right,s="mddtp-picker__view--pause";i.onclick=function(){e("mddtp-picker__view--right",t._sDialog.previous)},a.onclick=function(){e("mddtp-picker__view--left",t._sDialog.next)}}},{key:"_changeYear",value:function(e){var t=this;e.onclick=function(i){if(i.target&&"LI"===i.target.nodeName){var a=t._container.querySelector("#mddtp-date__currentYear"),s=t._sDialog.subtitle;a.id="",a.classList.remove("mddtp-picker__li--current"),i.target.id="mddtp-date__currentYear",i.target.classList.add("mddtp-picker__li--current"),t._switchToDateView(e,t),t._sDialog.tDate.year(parseInt(i.target.textContent,10)),t._fillText(s,""+t._sDialog.tDate.format("YYYY")),t._initViewHolder()}}}},{key:"_changeM",value:function(){var e=this,t=this._sDialog.AM,i=this._sDialog.PM;t.onclick=function(){var a="AM";e._sDialog.sDate._locale.isPM(e._sDialog.sDate.format("A"))&&(a="PM"),"PM"===a&&(e._sDialog.sDate.subtract(12,"h"),t.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))},i.onclick=function(){var a="AM";e._sDialog.sDate._locale.isPM(e._sDialog.sDate.format("A"))&&(a="PM"),"AM"===a&&(e._sDialog.sDate.add(12,"h"),t.classList.toggle("mddtp-picker__color--active"),i.classList.toggle("mddtp-picker__color--active"))}}},{key:"_dragDial",value:function(){var e=this,t=this._sDialog.needle,i=this._sDialog.circle,a=this._sDialog.fakeNeedle,s=this._sDialog.circularHolder,d=this._sDialog.minute,n="mddtp-picker__selection--quick",o="mddtp-picker__cell--selected",r=s.getBoundingClientRect(),c=void 0,_=new l.default(a,{containment:!0});_.on("pointerDown",function(){r=s.getBoundingClientRect()}),_.on("pointerMove",function(i){var a=i.clientX,s=i.clientY;if(void 0===a)if(void 0===i.pageX){if(!(i.touches&&i.touches.length>0))throw new Error("coult not detect pageX, pageY");a=i.touches[0].clientX,s=i.touches[0].clientY}else a=i.pageX-document.body.scrollLeft-document.documentElement.scrollLeft,s=i.pageY-document.body.scrollTop-document.documentElement.scrollTop;var l=a-r.left-r.width/2,o=s-r.top-r.height/2,_=Math.atan2(-o,l);t.className="",_<0&&(_+=2*Math.PI),_*=180/Math.PI,_=360-_,_>270&&(_-=360),c=parseInt(_/6);var h=Math.abs(6*c-_);Math.abs(6*(c+1)-_)<h&&c++,c+=15,t.classList.add("mddtp-picker__selection"),t.classList.add(n),t.classList.add("mddtp-picker__cell--rotate-"+2*c),d.textContent=e._numWithZero(c)});var h=function(){var s=e._sDialog.minuteView.getElementsByTagName("div"),l="mddtp-minute__selected",_=e._container.querySelector("#"+l),h=i.getBoundingClientRect();a.style.left="left:"+(h.left-r.left)+"px",a.style.top="top:"+(h.top-r.top)+"px",t.classList.remove(n);var m=c;1===m&&(m=60),m=e._nearestDivisor(m,5),60===c&&(c=0),_&&(_.id="",_.classList.remove(o)),m>0&&(m/=5,m--,s[m].id=l,s[m].classList.add(o)),d.textContent=e._numWithZero(c),e._sDialog.sDate.minutes(c)};_.on("pointerUp",h),_.on("dragEnd",h)}},{key:"_attachEventHandlers",value:function(){var e=this,t=this._sDialog.ok,i=this._sDialog.cancel,a=this._sDialog.unset,s=new CustomEvent("onCancel"),d=new CustomEvent("onOk"),l=new CustomEvent("onUnset");a&&(a.onclick=function(){e.toggle(),e._trigger&&e._trigger.dispatchEvent(l)}),i.onclick=function(){e.toggle(),e._trigger&&e._trigger.dispatchEvent(s)},t.onclick=function(){e._begin=e._sDialog.bDate,e._end=e._sDialog.eDate,e._init=e._sDialog.sDate,e.toggle(),e._trigger&&e._trigger.dispatchEvent(d)}}},{key:"_setButtonText",value:function(){this._sDialog.cancel.textContent=this._cancel,this._sDialog.ok.textContent=this._ok,this._unset&&(this._sDialog.unset.textContent=this._unset)}},{key:"_getMonth",value:function(e,t){var i=void 0;return i=e.clone(),t>0?i.add(Math.abs(t),"M"):i.subtract(Math.abs(t),"M")}},{key:"_nearestDivisor",value:function(e,t){return e%t==0?e:(e-1)%t==0?e-1:(e+1)%t==0?e+1:-1}},{key:"_numWithZero",value:function(e){return e>9?""+e:"0"+e}},{key:"_fillText",value:function(e,t){e.firstChild?e.firstChild.nodeValue=t:e.appendChild(document.createTextNode(t))}},{key:"_addId",value:function(e,t){e.id="mddtp-"+this._type+"__"+t}},{key:"_addClass",value:function(e,t,i){e.classList.add("mddtp-picker__"+t);var a=0;for(i&&(a=i.length,i.reverse());a--;)e.classList.add(i[a])}},{key:"_addView",value:function(e){for(var t=document.createElement("div"),i=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),l=d.default.weekdaysMin(!0).reverse(),n=7;n--;){var o=document.createElement("span");o.textContent=l[n],a.appendChild(o)}this._addClass(t,"month"),this._addClass(i,"grid"),this._addClass(a,"th"),this._addClass(s,"tr"),e.appendChild(t),e.appendChild(i),i.appendChild(a),i.appendChild(s)}},{key:"_calcRotation",value:function(e,t){return 12===e?t*=10:24===e?this._inner24===!0?(t>12&&(t-=12),t*=10):t*=5:t*=2,60===e&&0===t&&(t=120),"mddtp-picker__cell--rotate-"+t}},{key:"time",get:function(){return this._init},set:function(e){e&&(this._init=e)}},{key:"trigger",get:function(){return this._trigger},set:function(e){e&&(this._trigger=e)}}],[{key:"dialog",get:function(){return e._dialog},set:function(t){e._dialog=t}}]),e}();o._dialog={view:!0,state:!1},e.default=o});